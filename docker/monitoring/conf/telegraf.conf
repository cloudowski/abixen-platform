[tags]
dc = "local-1"

[agent]
interval = "10s"
debug = false

[[inputs.jolokia]]
  context = "/jolokia/"

[[inputs.jolokia.servers]]
  name = "web-client"
  host = "web-client"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "business-intelligence-service"
  host = "business-intelligence-service"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "configuration"
  host = "configuration"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "discovery"
  host = "discovery"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "gateway"
  host = "gateway"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "hystrix-dashboard"
  host = "hystrix-dashboard"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "web-content-service"
  host = "web-content-service"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "zipkin"
  host = "zipkin"
  port = "7777"

[[inputs.jolokia.servers]]
  name = "core"
  host = "core"
  port = "7777"

[[inputs.jolokia.metrics]]
    name = "spring_metrics"
    mbean  = "org.springframework.boot:name=metricsEndpoint,type=Endpoint"
    attribute = "Data"

[[inputs.docker]]
  endpoint = "unix:///var/run/docker.sock"
  container_names = []

[[inputs.postgresql_extensible]]
  address   = "user=abixen password=fy2Lkxw201sV host=web-content-service-postgres-database dbname=abixen_platform_web_content_service sslmode=disable"
  databases = ["abixen_platform_web_content_service"]

[[inputs.postgresql_extensible]]
  address   = "user=abixen password=fy2Lkxw201sV host=business-intelligence-service-postgres-database dbname=abixen_platform_businessintelligence_service sslmode=disable"
  databases = ["abixen_platform_businessintelligence_service"]

[[inputs.postgresql_extensible]]
  address   = "user=abixen password=fy2Lkxw201sV host=core-postgres-database dbname=abixen_platform_core sslmode=disable"
  databases = ["abixen_platform_core"]

[[inputs.postgresql_extensible.query]]
  sqlquery="SELECT * FROM pg_stat_database"
  version=901
  withdbname=false
  tagvalue=""
[[inputs.postgresql_extensible.query]]
  sqlquery="SELECT * FROM pg_stat_bgwriter"
  version=901
  withdbname=false
  tagvalue=""
[[inputs.postgresql_extensible.query]]
  sqlquery="select * from sessions"
  version=901
  withdbname=false
  tagvalue="db,username,state"
[[inputs.postgresql_extensible.query]]
  sqlquery="select setting as max_connections from pg_settings where name='max_connections'"
  version=801
  withdbname=false
  tagvalue=""
[[inputs.postgresql_extensible.query]]
  sqlquery="select * from pg_stat_kcache"
  version=901
  withdbname=false
  tagvalue=""
[[inputs.postgresql_extensible.query]]
  sqlquery="select setting as shared_buffers from pg_settings where name='shared_buffers'"
  version=801
  withdbname=false
  tagvalue=""
[[inputs.postgresql_extensible.query]]
  sqlquery="SELECT db, count( distinct blocking_pid ) AS num_blocking_sessions, count( distinct blocked_pid) AS num_blocked_sessions FROM public.blocking_procs group by db"
  version=901
  withdbname=false
  tagvalue="db"


[outputs]
[outputs.influxdb]
  url = "http://influxdb:8086"
  database = "telegraf"
  precision = "s"


